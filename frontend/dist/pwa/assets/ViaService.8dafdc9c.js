import{api as i}from"./axios.c798e365.js";import{a as n,f as d}from"./utils.c3e36012.js";import{C as u}from"./ColecaoService.cdf7ac7c.js";import{A as l}from"./AuthenticateService.c3e240d2.js";class v{async getCroquiById(s){var e;try{const r=(await i.get(`/croquis/${s}`)).data;return(e=r.imagem)!=null&&e.url&&(r.imagem.url=n(r.imagem.url)),r}catch(a){throw new Error(a.response.data.error||"Erro desconhecido ao buscar croqui")}}async getAllCroquis(){var s;try{const a=(await i.get("/croquis/")).data;for(const r of a)(s=r.imagem)!=null&&s.url&&(r.imagem.url=n(r.imagem.url));return a}catch(e){throw new Error(e.response.data.error||"Erro desconhecido ao buscar croquis")}}async getCroquiByViaId(s){var e;try{const r=(await i.get(`/croquis/via/${s}`)).data;for(const o of r)(e=o.imagem)!=null&&e.url&&(o.imagem.url=n(o.imagem.url));return r}catch(a){throw new Error(a.response.data.error||"Erro desconhecido ao buscar croquis")}}}class p{async getViaById(s){var e,a;try{const o=(await i.get(`/vias/${s}`)).data,t=new v;return o.croquis=await t.getCroquiByViaId(o.id),d(o)}catch(r){throw new Error(((a=(e=r.response)==null?void 0:e.data)==null?void 0:a.error)||"Erro desconhecido ao buscar via")}}async getAllVias(s,e){var a,r;try{const o={};s!==void 0&&(o.page=s),e!==void 0&&(o.limit=e);const t=await i.get("/vias/",{params:o}),c=t.data.vias,w=t.data.total;return{vias:c.map(d),total:w}}catch(o){throw new Error(((r=(a=o.response)==null?void 0:a.data)==null?void 0:r.error)||"Erro desconhecido ao buscar vias")}}async searchVias(s,e){var a,r;try{const o=await i.get("/vias/search",{params:{name:s,...e}}),t=o.data.vias,c=o.data.total;return{vias:t.map(d),total:c}}catch(o){throw new Error(((r=(a=o.response)==null?void 0:a.data)==null?void 0:r.error)||"Erro desconhecido ao buscar vias")}}async addToFavorites(s){if(!l.isAuthenticated())throw new Error("Usuario n\xE3o autenticado");if(!localStorage.getItem("userId"))throw new Error("Usuario n\xE3o encontrado");const r=(await u.getByUsuarioId()).find(o=>o.nome==="Vias Favoritas");if(!r)throw new Error("Cole\xE7\xE3o de favoritos n\xE3o encontrada");await u.addViaToColecao(r.id,s)}}var q=new p;export{q as V};
